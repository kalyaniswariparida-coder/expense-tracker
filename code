import csv
import os
from datetime import datetime

FILENAME = "expenses.csv"

def init_file():
    if not os.path.exists(FILENAME):
        with open(FILENAME, mode="w", newline='') as file:
            writer = csv.writer(file)
            writer.writerow(["Amount", "Category", "Date", "Note"])

def add_expense():
    amount = input("Amount: ")
    category = input("Category: ")
    date = input("Date (YYYY-MM-DD): ")
    note = input("Note: ")

    with open(FILENAME, mode="a", newline='') as file:
        writer = csv.writer(file)
        writer.writerow([amount, category, date, note])
    print("‚úÖ Expense added successfully!")

def view_expenses():
    with open(FILENAME, mode="r") as file:
        reader = csv.reader(file)
        next(reader)  # Skip header
        print("\n--- All Expenses ---")
        for row in reader:
            print(row)

def total_by_category():
    totals = {}
    with open(FILENAME, mode="r") as file:
        reader = csv.DictReader(file)
        for row in reader:
            category = row["Category"]
            amount = float(row["Amount"])
            totals[category] = totals.get(category, 0) + amount

    print("\n--- Total by Category ---")
    for cat, amt in totals.items():
        print(f"{cat}: ‚Çπ{amt:.2f}")

def total_by_date():
    totals = {}
    with open(FILENAME, mode="r") as file:
        reader = csv.DictReader(file)
        for row in reader:
            date = row["Date"]
            amount = float(row["Amount"])
            totals[date] = totals.get(date, 0) + amount

    print("\n--- Total by Date ---")
    for d, amt in totals.items():
        print(f"{d}: ‚Çπ{amt:.2f}")

def main():
    init_file()
    while True:
        print("\n==== Personal Expense Tracker ====")
        print("1. Add Expense")
        print("2. View All Expenses")
        print("3. View Total by Category")
        print("4. View Total by Date")
        print("5. Exit")
        choice = input("Enter your choice: ")

        if choice == "1":
            add_expense()
        elif choice == "2":
            view_expenses()
        elif choice == "3":
            total_by_category()
        elif choice == "4":
            total_by_date()
        elif choice == "5":
            print("üëã Goodbye!")
            break
        else:
            print("‚ùå Invalid choice. Try again.")

if __name__ == "__main__":
    main()
